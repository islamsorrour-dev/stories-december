# generate_audio.py
from gtts import gTTS
import os

# يجب أن يتطابق المسار مع مسار وسم <audio src="audio/..."> في ملف HTML 
OUTPUT_DIR = "audio" 

# قائمة تحتوي على نصوص القصة وأسماء الملفات المقابلة
STORY_SEGMENTS = [
    # الصفحة 1
    {"text": "في يوم الصبح، ليلى وأمير قعدوا مع ماما على السفرة عشان يفطروا. ماما قالت وهي مبتسمة: يا ليلى، قبل ما ناكل بنقول إيه؟", "filename": "page1.mp3"},
    # الصفحة 2
    {"text": "ليلى رفعت إيدها وقالت بصوت فرحان: بسم الله الرحمن الرحيم! ماما صقفت وقالت: برافو عليكي يا ليلى! دي أول حاجة حلوة بنعملها قبل الأكل.", "filename": "page2.mp3"},
    # الصفحة 3
    {"text": "أمير مد إيده بسرعة على العيش، ليلى قالتله بلُطف: لأ يا أمير، كُل بإيدك اليمين! ضحك أمير وقال: أوه نسيت يا ليلى! وخد لقمة صغيرة بإيده اليمين.", "filename": "page3.mp3"},
    # الصفحة 4
    {"text": "بعد شوية، أمير اتكلم وفمه مليان أكل. ماما قالتله بهدوء: يا أمير يا حبيبي، ماينفعش نتكلم وإحنا بناكل، استنى لما تبلع الأول.", "filename": "page4.mp3"},
    # الصفحة 5
    {"text": "أمير بص لماما وقال: حاضر يا ماما. ولما خلصوا الأكل، ليلى قالت: الحمد لله اللي أكلنا وسقانا.", "filename": "page5.mp3"},
    # الصفحة 6
    {"text": "ماما ابتسمت وقالت: شُطّار! كده أنا مبسوطة منكم، النهارده اتعلمتوا آداب الأكل والشرب. ضحك أمير وقال: الحمد لله! وضحكت ليلى معاه، والكل كان مبسوط.", "filename": "page6.mp3"},
    # الصفحة 7 (صفحة المعنى)
    {"text": "المعنى من القصة: لما ناكل بأدب ونشكر ربنا، بنبقى أطفال مهذّبين وربنا بيحبّنا. أهداف القصة: الطفل يقول بسم الله قبل الأكل والحمد لله بعد ما يخلص. ياكل بإيده اليمين. مايتكلمش وهو بياكل. يقعد بهدوء وقت الأكل. يتعلم يشكر ربنا على النعمة.", "filename": "page7.mp3"},
    # صوت صفحة الأسئلة
    {"text": "هل استمتعت بالقصة؟ الآن حان وقت اختبار معلوماتك! أولاً: اختار الإجابة الصحيحة، ثانياً: ضع علامة صح أو خطأ. اضغط على زر ابدأ الأسئلة.", "filename": "quiz.mp3"},
]

# 1. إنشاء مجلد الإخراج إذا لم يكن موجوداً
if not os.path.exists(OUTPUT_DIR):
    os.makedirs(OUTPUT_DIR)

# 2. حلقة التوليد والحفظ
for segment in STORY_SEGMENTS:
    try:
        text = segment["text"]
        filename = segment["filename"]
        
        tts = gTTS(text=text, lang='ar', slow=False)
        output_path = os.path.join(OUTPUT_DIR, filename)
        
        tts.save(output_path)
        print(f"✅ تم توليد: {filename}")
        
    except Exception as e:
        print(f"❌ حدث خطأ أثناء توليد {filename}: {e}")