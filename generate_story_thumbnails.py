# generate_story_thumbnails.py
# ุณูุฑูุจุช ูุชูููุฏ ุงูุตูุฑ ุงููุตุบุฑุฉ ูููุตุต ุงูู 50

from PIL import Image, ImageDraw, ImageFont
import os

# ูุงุฆูุฉ ุงููุตุต ุงูู 50
stories = [
    "ุขุฏุงุจ ุงูุทุนุงู ูุงูุดุฑุงุจ",
    "ุงููุธุงูุฉ ุงูุดุฎุตูุฉ",
    "ุงุญุชุฑุงู ุงููุงูุฏูู",
    "ุขุฏุงุจ ุงูุญุฏูุซ ูุงูุงุณุชุฆุฐุงู",
    "ุจุฑู ุงูุฌูุฑุงู",
    "ุงูุตุฏู ูุงูุฃูุงูุฉ",
    "ุงูุชุนุงูู ูุงููุดุงุฑูุฉ",
    "ุงุญุชุฑุงู ุงููุนูููู",
    "ุงูุงูุชุฒุงู ูู ุงููุฏุฑุณุฉ",
    "ุงููุธุงู ูุงูุชุฑุชูุจ",
    "ูุณุงุนุฏุฉ ูุจุงุฑ ุงูุณู",
    "ุงูุญูุงุธ ุนูู ุงูููุชููุงุช ุงูุนุงูุฉ",
    "ุขุฏุงุจ ุงุณุชุฎุฏุงู ุงููุงุชู",
    "ุขุฏุงุจ ุงูุทุฑูู ูุงููุฑูุฑ",
    "ุถุจุท ุงูููุณ ููุช ุงูุบุถุจ",
    "ุงูุชูุงุถุน",
    "ุงูุงุนุชุฐุงุฑ ุนูุฏ ุงูุฎุทุฃ",
    "ุญุจ ุงููุทู",
    "ุงุญุชุฑุงู ุงูุขุฎุฑ",
    "ุงูุตุจุฑ ูุงูุงุฌุชูุงุฏ",
    "ุงูุดูุฑ ูุงูุนุฑูุงู",
    "ุงูุนุทุงุก ูุงูุนูู ุงูุฌูุงุนู",
    "ุงุญุชุฑุงู ุงูููุช",
    "ุงูุชูุงุนู ุงูุฅูุฌุงุจู ูู ุงูุฃูุดุทุฉ",
    "ุชูุจู ุงูููุฏ",
    "ุงูุงูุชูุงู ุจุงูุจูุฆุฉ",
    "ุชุฌูุจ ุงูุชููุฑ",
    "ุงูุญูุงุธ ุนูู ุงูุฎุตูุตูุฉ",
    "ุงูุชุนุงูู ูุน ุงูุฃุณุฑุฉ",
    "ุงูุชุนุจูุฑ ุนู ุงููุดุงุนุฑ ุจุดูู ุตุญู",
    "ูุณุงุนุฏุฉ ุงูุฒููุงุก",
    "ุงุญุชุฑุงู ุงูุงุฎุชูุงู",
    "ุขุฏุงุจ ุงุณุชุฎุฏุงู ุงูุฅูุชุฑูุช",
    "ุชุฑุชูุจ ุงูุฃุฏูุงุช ุจุนุฏ ุงููุนุจ",
    "ููู ุงูุญูููุฉ",
    "ุงุญุชุฑุงู ุงูุฃุฏูุงุฑ",
    "ุงุฎุชูุงุฑ ุงูุฃุตุฏูุงุก",
    "ุงูุงุนุชูุงุก ุจุงูุญููุงูุงุช",
    "ุงุญุชุฑุงู ุงูููุงููู",
    "ุงููุจุงุฏุฑุฉ ุจุงูุฃุนูุงู ุงูุทูุจุฉ",
    "ููู \"ูู ูุถูู\" ู\"ุดูุฑูุง\"",
    "ุงูุญูุงุธ ุนูู ุงููุฏูุก ุฏุงุฎู ุงูุตู",
    "ุงูุชุญูู ูู ุงูุงููุนุงูุงุช",
    "ุงูุชูููุฑ ูุจู ุงูุชุตุฑู",
    "ุงูุงูุชุฒุงู ุจุงููุงุฌุจุงุช",
    "ูุดุงุฑูุฉ ุงูุฃูุนุงุจ",
    "ุงุญุชุฑุงู ุงููุนูููู",
    "ุญุจ ุงูุชุนูู",
    "ุงูุซูุฉ ุจุงูููุณ ุฏูู ุบุฑูุฑ",
    "ุชูููู ุนุงุฏุงุช ุฅูุฌุงุจูุฉ ููููุฉ"
]

# ุงูุฃููุงู ุงููุณุชุฎุฏูุฉ ูู ุงูุชุตููู
colors = [
    ("#7b4397", "#dc2430"),  # ุจููุณุฌู - ุฃุญูุฑ
    ("#dc2430", "#ffc107"),  # ุฃุญูุฑ - ุฃุตูุฑ
    ("#ffc107", "#7b4397"),  # ุฃุตูุฑ - ุจููุณุฌู
    ("#7b4397", "#ffc107"),  # ุจููุณุฌู - ุฃุตูุฑ
    ("#dc2430", "#7b4397"),  # ุฃุญูุฑ - ุจููุณุฌู
]

# ุฃููููุงุช ูุฎุชููุฉ ูููุตุต
icons = [
    "๐", "๐", "โจ", "๐", "๐ซ",
    "๐ฏ", "๐จ", "๐ญ", "๐ช", "๐ฌ",
    "๐", "๐", "๐", "๐", "๐",
    "๐", "๐", "๐", "๐", "๐",
    "๐บ", "๐ป", "๐ท", "๐น", "๐ธ",
    "๐ฟ", "๐", "๐ฑ", "๐ณ", "๐ด",
    "โญ", "๐", "โจ", "๐ซ", "โก",
    "๐ฅ", "๐ง", "๐", "โ๏ธ", "๐",
    "๐", "โ๏ธ", "โ๏ธ", "๐", "๐",
    "๐", "๐บ๏ธ", "๐๏ธ", "โฐ๏ธ", "๐"
]

def hex_to_rgb(hex_color):
    """ุชุญููู ููู hex ุฅูู RGB"""
    hex_color = hex_color.lstrip('#')
    return tuple(int(hex_color[i:i+2], 16) for i in (0, 2, 4))

def create_thumbnail(story_name, story_id, output_dir="images"):
    """ุฅูุดุงุก ุตูุฑุฉ ูุตุบุฑุฉ ูููุตุฉ"""
    # ุฅูุดุงุก ูุฌูุฏ ุงูุฅุฎุฑุงุฌ ุฅุฐุง ูู ููู ููุฌูุฏุงู
    if not os.path.exists(output_dir):
        os.makedirs(output_dir)
    
    # ุฃุจุนุงุฏ ุงูุตูุฑุฉ
    width, height = 400, 300
    
    # ุฅูุดุงุก ุตูุฑุฉ ุจุฎูููุฉ ูุชุฏุฑุฌุฉ
    color_index = (story_id - 1) % len(colors)
    color1, color2 = colors[color_index]
    
    rgb1 = hex_to_rgb(color1)
    rgb2 = hex_to_rgb(color2)
    
    # ุฅูุดุงุก ุตูุฑุฉ ุจุฎูููุฉ ูุชุฏุฑุฌุฉ
    img = Image.new('RGB', (width, height), rgb1)
    draw = ImageDraw.Draw(img)
    
    # ุฑุณู ูุชุฏุฑุฌ ุจุณูุท
    for y in range(height):
        ratio = y / height
        r = int(rgb1[0] * (1 - ratio) + rgb2[0] * ratio)
        g = int(rgb1[1] * (1 - ratio) + rgb2[1] * ratio)
        b = int(rgb1[2] * (1 - ratio) + rgb2[2] * ratio)
        draw.line([(0, y), (width, y)], fill=(r, g, b))
    
    # ูุญุงููุฉ ุงุณุชุฎุฏุงู ุฎุท ุนุฑุจู (ุฅุฐุง ูุงู ูุชููุฑุงู)
    font_large = None
    font_small = None
    
    # ูุงุฆูุฉ ูุณุงุฑุงุช ุงูุฎุทูุท ุงููุญุชููุฉ
    font_paths = [
        "C:/Windows/Fonts/arial.ttf",
        "C:/Windows/Fonts/tahoma.ttf",
        "C:/Windows/Fonts/segoeui.ttf",
        "arial.ttf",
        "tahoma.ttf"
    ]
    
    for font_path in font_paths:
        try:
            if os.path.exists(font_path):
                font_large = ImageFont.truetype(font_path, 40)
                font_small = ImageFont.truetype(font_path, 20)
                break
        except:
            continue
    
    if font_large is None:
        # ุงุณุชุฎุฏุงู ุฎุท ุงูุชุฑุงุถู
        font_large = ImageFont.load_default()
        font_small = ImageFont.load_default()
    
    # ุฅุถุงูุฉ ูุต ุงุณู ุงููุตุฉ
    text = story_name
    
    # ุญุณุงุจ ููุถุน ุงููุต (ูู ุงูููุชุตู)
    # ุงุณุชุฎุฏุงู textbbox ููุญุตูู ุนูู ุฃุจุนุงุฏ ุงููุต
    try:
        bbox = draw.textbbox((0, 0), text, font=font_large)
        text_width = bbox[2] - bbox[0]
        text_height = bbox[3] - bbox[1]
    except:
        # ูู ุญุงูุฉ ุงูุฎุท ุงูุงูุชุฑุงุถู
        text_width = len(text) * 20
        text_height = 40
    
    x = (width - text_width) // 2
    y = (height - text_height) // 2 - 10
    
    # ุฑุณู ุฎูููุฉ ุดุจู ุดูุงูุฉ ูููุต (ุจูุถุงุก ูุน ุดูุงููุฉ)
    padding = 20
    overlay = Image.new('RGBA', (width, height), (0, 0, 0, 0))
    overlay_draw = ImageDraw.Draw(overlay)
    overlay_draw.rectangle(
        [x - padding, y - padding, x + text_width + padding, y + text_height + padding],
        fill=(255, 255, 255, 220)
    )
    img = Image.alpha_composite(img.convert('RGBA'), overlay).convert('RGB')
    draw = ImageDraw.Draw(img)
    
    # ุฑุณู ุงููุต ุจุงูููู ุงูุฏุงูู
    draw.text((x, y), text, fill=(50, 50, 50), font=font_large)
    
    # ุฅุถุงูุฉ ุฑูู ุงููุตุฉ ูู ุงูุฒุงููุฉ
    story_num = f"#{story_id}"
    bbox_num = draw.textbbox((0, 0), story_num, font=font_small)
    num_width = bbox_num[2] - bbox_num[0]
    num_height = bbox_num[3] - bbox_num[1]
    
    # ุฎูููุฉ ููุฑูู
    draw.ellipse(
        [width - 50, 10, width - 10, 50],
        fill=(255, 255, 255, 230)
    )
    draw.text((width - 50 + (40 - num_width) // 2, 10 + (40 - num_height) // 2), 
              story_num, fill=(123, 67, 151), font=font_small)
    
    # ุญูุธ ุงูุตูุฑุฉ
    output_path = os.path.join(output_dir, f"story-{story_id}.jpg")
    img.save(output_path, "JPEG", quality=95)
    print(f"โ ุชู ุฅูุดุงุก: {output_path} - {story_name}")

def main():
    print("๐ ุจุฏุก ุชูููุฏ ุงูุตูุฑ ุงููุตุบุฑุฉ ูููุตุต...\n")
    
    for i, story_name in enumerate(stories, 1):
        try:
            create_thumbnail(story_name, i)
        except Exception as e:
            print(f"โ ุฎุทุฃ ูู ุฅูุดุงุก ุตูุฑุฉ ุงููุตุฉ {i}: {e}")
    
    print(f"\nโจ ุชู ุฅูุดุงุก {len(stories)} ุตูุฑุฉ ูุตุบุฑุฉ ุจูุฌุงุญ!")

if __name__ == "__main__":
    main()

